

步进电机 57BYG250B-8
1.8°
3A
1.2N

黑A+
绿A-
红B+
蓝B-




驱动器 DM542
强电20-50V

信号电压高电平4-5V，低电平0-0.5V；
PUL，脉冲宽度应大于1.2us，最大频率 200kHz；
DIR，改变转向，必须在脉冲信号前5us输入；初始转向，可通过调换电机任意绕组实现，如调换A+和A-；
* 默认是逆时针转动，如果dir上施加电势，则反向，变为顺时针；
ENA,有5V电势时，电机将断电，不响应任何控制；

当前跳线
1100 0011
110 - 2.84A
0 -
0011 - 1600 steps/rev


[其他信息见说明书pdf]




pico部分
28个输出针，每3个可控制一个电机，所以建议最大控制数量为8个（占用24个针）

量核心分工
core0，用于接收和反馈用户指令，分解指令为电机驱动脉冲序列；
core1，电机脉冲驱动时钟，按照脉冲序列控制电机动作；



程序部分
初始化电机若干；
注册时钟，在core1；
就绪…… 等待用户输入；






实验：
timer最小间隔54us（9259.26 steps/sec），再小timer本身就会报错；
* 54,55偶尔会报错，尝试56us；
在此间隔下，测试程序均正常，没有程序级的失步；

pico 3.3v 信号接入5v信号的驱动器或导致驱动不正常，抖动；（也可能和细分设置有关，看下面）
需要用脉冲转换器，将3.3v信号转换为5v信号，注意转换器本身有极限频率限制，我看的一款是20kHz，高速的有20mHz的。。


细分测试（全流模式）
spr      结果
1600     乱飘，无论频率多少；
800      一旦开始转动，则会出现啸叫，停止脉冲后，啸叫不停止；
400      同800；
3200     正常！



空载测试（3200spr）
转动测试
频率      正转     反转
9259.25




最大可转动频率
时钟间隔         频率	最小变速	最小变动(达到全速时)
56	8928.571429  9884	81002
100	5000         3100	7702

变动转动，每次都要计算启动和停止序列，因为步数不同，变速时机不同，使得变速序列每次不同；
但只要步数超过8064，则会内存溢出；

针对上面问题，测试发现，每个vector最大内容数量限制在256个；
另Heap区域也只有区区240k；
所以，代码中增加了计算序列前的检查，如果可用Heap小于130k，则抛出异常停止后续代码；


** 只测试了1电机的情况，多个电机的话，估计会更糟，毕竟pico的内存实在是太小了；









